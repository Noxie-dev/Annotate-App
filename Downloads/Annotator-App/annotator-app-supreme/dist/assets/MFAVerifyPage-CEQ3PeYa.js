import{j as e}from"./radix-ui-Dm4GcI-M.js";import{u as V,i as E,a as s}from"./react-vendor-BxpQIQ7B.js";import{u as L}from"./index-CeiQEl0I.js";import{m as x}from"./mfa-service-BYrLSgLl.js";import{B as n}from"./button-BU14-tcR.js";import{I as h}from"./input-B_Pc9ca6.js";import{L as p}from"./label--JKAZs82.js";import{C as P,a as B,b as D,c as I,d as F}from"./card-BRJUXXhw.js";import{A as b,a as f}from"./alert-B94VLGCJ.js";import{T as U,a as H,b as g,c as y}from"./tabs-C8PfzfW2.js";import{S as K,C as j,K as z}from"./utils-vendor-DzewcVAv.js";import"./pdf-vendor-BQ5_-Qxz.js";import"./data-vendor-7zrJSdJt.js";function ee(){const v=V(),[N]=E(),{user:r}=L(),[t,d]=s.useState(!1),[m,c]=s.useState(null),[l,C]=s.useState(""),[i,w]=s.useState(""),k=N.get("redirect")||"/dashboard",u=async(a,o=!1)=>{if(!r||!a||(o?a.length<5:a.length!==6)){c(o?"Please enter a valid backup code":"Please enter a valid 6-digit code");return}d(!0),c(null);try{o?await x.verifyBackupCode(r.id,a):await x.verifyTOTP(r.id,a),v(k,{replace:!0})}catch(A){c(A.message||"Invalid verification code")}finally{d(!1)}},S=a=>{a.preventDefault(),u(l,!1)},T=a=>{a.preventDefault(),u(i,!0)};return e.jsx("div",{className:"min-h-screen bg-[#0f1419] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-200",children:"Two-factor authentication"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Enter your verification code to continue"})]}),e.jsxs(P,{className:"bg-[#1a1f2e] border-gray-700",children:[e.jsxs(B,{children:[e.jsx(D,{className:"text-xl text-gray-200",children:"Verify your identity"}),e.jsx(I,{className:"text-gray-400",children:"Use your authenticator app or a backup code"})]}),e.jsxs(F,{children:[m&&e.jsxs(b,{className:"bg-red-900/20 border-red-800 mb-4",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx(f,{className:"text-red-300",children:m})]}),e.jsxs(U,{defaultValue:"authenticator",className:"w-full",children:[e.jsxs(H,{className:"grid w-full grid-cols-2 bg-[#0f1419]",children:[e.jsx(g,{value:"authenticator",className:"data-[state=active]:bg-[#1a1f2e] data-[state=active]:text-gray-200",children:"Authenticator"}),e.jsx(g,{value:"backup",className:"data-[state=active]:bg-[#1a1f2e] data-[state=active]:text-gray-200",children:"Backup Code"})]}),e.jsx(y,{value:"authenticator",className:"space-y-4 mt-4",children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"verificationCode",className:"text-gray-300",children:"Authentication code"}),e.jsx(h,{id:"verificationCode",type:"text",placeholder:"000000",value:l,onChange:a=>C(a.target.value.replace(/\D/g,"").slice(0,6)),className:"bg-[#0f1419] border-gray-600 text-gray-200 placeholder-gray-500 text-center text-lg tracking-widest",maxLength:6,autoComplete:"one-time-code"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Enter the 6-digit code from your authenticator app"})]}),e.jsx(n,{type:"submit",disabled:t||l.length!==6,className:"w-full bg-blue-600 hover:bg-blue-700",children:t?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Verifying..."]}):"Verify code"})]})}),e.jsxs(y,{value:"backup",className:"space-y-4 mt-4",children:[e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"backupCode",className:"text-gray-300 flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Backup recovery code"]}),e.jsx(h,{id:"backupCode",type:"text",placeholder:"12345-67890",value:i,onChange:a=>w(a.target.value.toUpperCase()),className:"bg-[#0f1419] border-gray-600 text-gray-200 placeholder-gray-500 text-center font-mono",autoComplete:"one-time-code"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Enter one of your backup recovery codes"})]}),e.jsx(n,{type:"submit",disabled:t||i.length<5,className:"w-full bg-blue-600 hover:bg-blue-700",children:t?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Verifying..."]}):"Use backup code"})]}),e.jsxs(b,{className:"bg-yellow-900/20 border-yellow-800",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsxs(f,{className:"text-yellow-300",children:[e.jsx("strong",{children:"Note:"})," Each backup code can only be used once."]})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-700 text-center",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Having trouble accessing your codes?"}),e.jsx(n,{variant:"ghost",size:"sm",className:"text-blue-400 hover:text-blue-300 hover:bg-transparent",onClick:()=>{console.log("Account recovery flow")},children:"Contact support"})]})]})]})]})})}export{ee as default};

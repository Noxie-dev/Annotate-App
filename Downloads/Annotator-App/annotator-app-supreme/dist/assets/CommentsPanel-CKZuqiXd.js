import{j as e}from"./radix-ui-Dm4GcI-M.js";import{a as j}from"./react-vendor-BxpQIQ7B.js";import{b as A}from"./index-CeiQEl0I.js";import{B as l}from"./button-BU14-tcR.js";import{A as N,a as u,b as f}from"./avatar-Dqh11rFN.js";import{B as z}from"./badge-CzkljnjK.js";import{T as D}from"./select-BvRLeJVF.js";import{j as v,l as S,aa as I,aH as B,aI as P,o as E,aD as M}from"./utils-vendor-DzewcVAv.js";import"./pdf-vendor-BQ5_-Qxz.js";import"./data-vendor-7zrJSdJt.js";function Q(){const{annotations:o,users:b,updateAnnotation:y,deleteAnnotation:w,setCurrentPage:C}=A(),[T,m]=j.useState(null),[i,d]=j.useState(""),n=o.filter(s=>s.type==="text-comment"),h=s=>b.find(t=>t.id===s),R=s=>{if(!i.trim())return;const t=o.find(c=>c.id===s);if(!t)return;const x={id:`reply-${Date.now()}`,userId:"user-1",content:i,timestamp:new Date().toISOString()};y(s,{replies:[...t.replies||[],x]}),d(""),m(null)},k=s=>{C(s.pageNumber)},g=s=>M(new Date(s),{addSuffix:!0});return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-4 border-b border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-200 flex items-center",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Comments & Notes"]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[n.length," ",n.length===1?"comment":"comments"]})]}),e.jsxs(z,{variant:"secondary",className:"bg-blue-900/20 text-blue-400",children:[n.filter(s=>{var t;return!((t=s.replies)!=null&&t.length)}).length," new"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(v,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"No comments yet"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Click on the document to add your first comment"})]}):n.map(s=>{var c;const t=h(s.userId),x=T===s.id;return e.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 bg-[#0f1419]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(N,{className:"w-6 h-6",children:[e.jsx(u,{src:t==null?void 0:t.avatar,alt:t==null?void 0:t.name}),e.jsx(f,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white text-xs",children:((c=t==null?void 0:t.name)==null?void 0:c.charAt(0))||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-200",children:t==null?void 0:t.name}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-400",children:[e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:g(s.timestamp)})]})]})]}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>k(s),className:"text-blue-400 hover:text-blue-300 p-1",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-xs ml-1",children:["Page ",s.pageNumber]})]})]}),e.jsx("p",{className:"text-sm text-gray-200 mb-3",children:s.content}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>m(x?null:s.id),className:"text-gray-400 hover:text-gray-200 text-xs",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),"Reply"]}),e.jsxs(l,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-200 text-xs",children:[e.jsx(P,{className:"w-3 h-3 mr-1"}),"Edit"]}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>w(s.id),className:"text-red-400 hover:text-red-300 text-xs",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),"Delete"]})]}),s.replies&&s.replies.length>0&&e.jsx("div",{className:"border-l-2 border-gray-600 pl-4 space-y-3",children:s.replies.map(r=>{var p;const a=h(r.userId);return e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(N,{className:"w-5 h-5",children:[e.jsx(u,{src:a==null?void 0:a.avatar,alt:a==null?void 0:a.name}),e.jsx(f,{className:"bg-gradient-to-r from-green-500 to-blue-600 text-white text-xs",children:((p=a==null?void 0:a.name)==null?void 0:p.charAt(0))||"?"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-300",children:a==null?void 0:a.name}),e.jsx("span",{className:"text-xs text-gray-500",children:g(r.timestamp)})]}),e.jsx("p",{className:"text-xs text-gray-200",children:r.content})]})]},r.id)})}),x&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(D,{value:i,onChange:r=>d(r.target.value),placeholder:"Write a reply...",className:"bg-[#1a1f2e] border-gray-600 text-gray-200 text-sm resize-none",rows:2}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{size:"sm",onClick:()=>R(s.id),disabled:!i.trim(),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs",children:"Reply"}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{m(null),d("")},className:"text-gray-400 hover:text-gray-200 text-xs",children:"Cancel"})]})]})]},s.id)})})]})}export{Q as CommentsPanel};

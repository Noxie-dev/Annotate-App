import{j as e}from"./radix-ui-Dm4GcI-M.js";import{u as q,a as t}from"./react-vendor-BxpQIQ7B.js";import{u as L}from"./index-CeiQEl0I.js";import{m as o}from"./mfa-service-BYrLSgLl.js";import{B as r}from"./button-BU14-tcR.js";import{I as U}from"./input-B_Pc9ca6.js";import{L as D}from"./label--JKAZs82.js";import{C as f,a as b,b as v,c as w,d as p}from"./card-BRJUXXhw.js";import{A as x,a as m}from"./alert-B94VLGCJ.js";import{S as C,C as j,e as V,f as S,d as P,K as z}from"./utils-vendor-DzewcVAv.js";import"./pdf-vendor-BQ5_-Qxz.js";import"./data-vendor-7zrJSdJt.js";function ae(){const g=q(),{user:a}=L(),[h,y]=t.useState(1),[i,n]=t.useState(!1),[d,l]=t.useState(null),[c,k]=t.useState(""),[N,A]=t.useState([]),[F,E]=t.useState(""),[u,R]=t.useState(""),I=async()=>{if(a){n(!0),l(null);try{const s=await o.setupMFA(a.id,a.email);E(s.qrCodeUrl),R(s.secretKey),A(s.backupCodes),y(2)}catch(s){l(s.message||"Failed to setup MFA")}finally{n(!1)}}},M=async()=>{if(!a||!c||c.length!==6){l("Please enter a valid 6-digit code");return}n(!0),l(null);try{await o.verifyMFASetup(a.id,c,u),y(3)}catch(s){l(s.message||"Invalid verification code")}finally{n(!1)}},B=()=>{const s=N.join(`
`);navigator.clipboard.writeText(s)},K=()=>{g("/dashboard")},Q=()=>{g("/dashboard")};return h===1?e.jsx("div",{className:"min-h-screen bg-[#0f1419] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(C,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-200",children:"Secure your account"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Set up two-factor authentication for enhanced security"})]}),e.jsxs(f,{className:"bg-[#1a1f2e] border-gray-700",children:[e.jsxs(b,{children:[e.jsx(v,{className:"text-xl text-gray-200",children:"Two-Factor Authentication"}),e.jsx(w,{className:"text-gray-400",children:"Add an extra layer of security to your account"})]}),e.jsxs(p,{className:"space-y-4",children:[a&&o.isMFARequired(a)&&e.jsxs(x,{className:"bg-blue-900/20 border-blue-800",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(m,{className:"text-blue-300",children:"Two-factor authentication is required for your account type."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-200 font-medium",children:"Install an authenticator app"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Download Google Authenticator, Authy, or similar app on your phone"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-200 font-medium",children:"Scan QR code"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Use your authenticator app to scan the QR code we'll provide"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-200 font-medium",children:"Enter verification code"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Enter the 6-digit code from your app to complete setup"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(r,{onClick:I,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Setting up..."]}):"Set up 2FA"}),a&&!o.isMFARequired(a)&&e.jsx(r,{onClick:Q,variant:"outline",className:"bg-[#0f1419] border-gray-600 text-gray-300 hover:bg-gray-800",children:"Skip for now"})]}),d&&e.jsxs(x,{className:"bg-red-900/20 border-red-800",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx(m,{className:"text-red-300",children:d})]})]})]})]})}):h===2?e.jsx("div",{className:"min-h-screen bg-[#0f1419] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-200",children:"Scan QR code"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Use your authenticator app to scan this QR code"})]}),e.jsx(f,{className:"bg-[#1a1f2e] border-gray-700",children:e.jsxs(p,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-48 h-48 bg-white rounded-lg mx-auto mb-4 flex items-center justify-center",children:e.jsx("img",{src:F,alt:"QR Code",className:"w-40 h-40"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Can't scan? Enter this code manually:"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("code",{className:"bg-[#0f1419] px-3 py-1 rounded text-gray-300 text-sm",children:u}),e.jsx(r,{size:"sm",variant:"ghost",onClick:()=>navigator.clipboard.writeText(u),className:"text-gray-400 hover:text-gray-200",children:e.jsx(S,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"verificationCode",className:"text-gray-300",children:"Enter verification code"}),e.jsx(U,{id:"verificationCode",type:"text",placeholder:"000000",value:c,onChange:s=>k(s.target.value.replace(/\D/g,"").slice(0,6)),className:"bg-[#0f1419] border-gray-600 text-gray-200 placeholder-gray-500 text-center text-lg tracking-widest",maxLength:6}),e.jsx("p",{className:"text-xs text-gray-400",children:"Enter the 6-digit code from your authenticator app"})]}),d&&e.jsxs(x,{className:"bg-red-900/20 border-red-800",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx(m,{className:"text-red-300",children:d})]}),e.jsx(r,{onClick:M,disabled:i||c.length!==6,className:"w-full bg-blue-600 hover:bg-blue-700",children:i?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Verifying..."]}):"Verify and continue"})]})})]})}):h===3?e.jsx("div",{className:"min-h-screen bg-[#0f1419] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(P,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-200",children:"Save backup codes"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Store these codes safely - you'll need them if you lose your phone"})]}),e.jsxs(f,{className:"bg-[#1a1f2e] border-gray-700",children:[e.jsxs(b,{children:[e.jsxs(v,{className:"text-lg text-gray-200 flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),"Backup Recovery Codes"]}),e.jsx(w,{className:"text-gray-400",children:"Each code can only be used once. Keep them in a safe place."})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsx("div",{className:"bg-[#0f1419] rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm font-mono",children:N.map((s,T)=>e.jsx("div",{className:"text-gray-300 py-1",children:s},T))})}),e.jsxs(r,{onClick:B,variant:"outline",className:"w-full bg-[#0f1419] border-gray-600 text-gray-300 hover:bg-gray-800",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Copy all codes"]}),e.jsxs(x,{className:"bg-yellow-900/20 border-yellow-800",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsxs(m,{className:"text-yellow-300",children:[e.jsx("strong",{children:"Important:"})," Save these codes in a secure location. You won't be able to see them again."]})]}),e.jsx(r,{onClick:K,className:"w-full bg-blue-600 hover:bg-blue-700",children:"I've saved my backup codes"})]})]})]})}):null}export{ae as default};

import{j as e}from"./radix-ui-Dm4GcI-M.js";import{i as Z,u as $,a as r,L as x}from"./react-vendor-BxpQIQ7B.js";import{u as q,o as D,s as j}from"./form-vendor-B0nP1T3w.js";import{t as G}from"./zod-CPQLszjv.js";import{B as n}from"./button-BU14-tcR.js";import{I as b}from"./input-B_Pc9ca6.js";import{L as y}from"./label--JKAZs82.js";import{C as N,d as v,a as H,b as M,c as O}from"./card-BRJUXXhw.js";import{A as W,a as J}from"./alert-B94VLGCJ.js";import{C as P,L as S,E as k,a as C}from"./utils-vendor-DzewcVAv.js";const K=D({password:j().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number").regex(/[^A-Za-z0-9]/,"Password must contain at least one special character"),confirmPassword:j()}).refine(o=>o.password===o.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function re(){const[o]=Z(),L=$(),[h,u]=r.useState(!1),[i,A]=r.useState(!1),[c,E]=r.useState(!1),[t,w]=r.useState(0),[p,d]=r.useState(null),g=o.get("token"),{register:f,handleSubmit:R,formState:{errors:l},watch:T}=q({resolver:G(K)}),m=T("password"),z=a=>{let s=0;return a.length>=8&&(s+=25),/[A-Z]/.test(a)&&(s+=25),/[a-z]/.test(a)&&(s+=25),/[0-9]/.test(a)&&(s+=12.5),/[^A-Za-z0-9]/.test(a)&&(s+=12.5),Math.min(s,100)};r.useState(()=>{w(m?z(m):0)});const F=async a=>{if(!g){d("Invalid or missing reset token");return}u(!0),d(null);try{await new Promise(s=>setTimeout(s,2e3)),L("/auth/login",{state:{message:"Password reset successfully. Please sign in with your new password."}})}catch(s){d(s.message||"Failed to reset password")}finally{u(!1)}},I=()=>t<25?"bg-red-500":t<50?"bg-orange-500":t<75?"bg-yellow-500":"bg-green-500",B=()=>t<25?"Weak":t<50?"Fair":t<75?"Good":"Strong";return g?e.jsx("div",{className:"min-h-screen bg-[#0f1419] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"A"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-200",children:"Reset your password"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Enter your new password below"})]}),e.jsxs(N,{className:"bg-[#1a1f2e] border-gray-700",children:[e.jsxs(H,{className:"space-y-1",children:[e.jsx(M,{className:"text-xl text-gray-200",children:"New password"}),e.jsx(O,{className:"text-gray-400",children:"Choose a strong password for your account"})]}),e.jsxs(v,{className:"space-y-4",children:[p&&e.jsxs(W,{className:"bg-red-900/20 border-red-800",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(J,{className:"text-red-300",children:p})]}),e.jsxs("form",{onSubmit:R(F),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"password",className:"text-gray-300",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(b,{id:"password",type:i?"text":"password",placeholder:"Enter your new password",...f("password"),className:"bg-[#0f1419] border-gray-600 text-gray-200 placeholder-gray-500 pl-10 pr-10"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>A(!i),children:i?e.jsx(k,{className:"h-4 w-4 text-gray-400"}):e.jsx(C,{className:"h-4 w-4 text-gray-400"})})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Password strength"}),e.jsx("span",{className:`text-xs ${t>=75?"text-green-400":t>=50?"text-yellow-400":"text-red-400"}`,children:B()})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${I()}`,style:{width:`${t}%`}})})]}),l.password&&e.jsx("p",{className:"text-sm text-red-400",children:l.password.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"confirmPassword",className:"text-gray-300",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(b,{id:"confirmPassword",type:c?"text":"password",placeholder:"Confirm your new password",...f("confirmPassword"),className:"bg-[#0f1419] border-gray-600 text-gray-200 placeholder-gray-500 pl-10 pr-10"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>E(!c),children:c?e.jsx(k,{className:"h-4 w-4 text-gray-400"}):e.jsx(C,{className:"h-4 w-4 text-gray-400"})})]}),l.confirmPassword&&e.jsx("p",{className:"text-sm text-red-400",children:l.confirmPassword.message})]}),e.jsx(n,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:h,children:h?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Resetting password..."]}):"Reset password"})]}),e.jsx("div",{className:"text-center pt-4 border-t border-gray-700",children:e.jsx(x,{to:"/auth/login",className:"text-sm text-blue-400 hover:text-blue-300",children:"Back to sign in"})})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-[#0f1419] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center mx-auto mb-4",children:e.jsx(P,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-200",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"This password reset link is invalid or has expired"})]}),e.jsx(N,{className:"bg-[#1a1f2e] border-gray-700",children:e.jsxs(v,{className:"p-6 text-center space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"The password reset link you clicked is either invalid or has expired. Please request a new password reset link."}),e.jsx(x,{to:"/auth/forgot-password",children:e.jsx(n,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"Request New Reset Link"})}),e.jsx(x,{to:"/auth/login",className:"inline-block text-sm text-blue-400 hover:text-blue-300",children:"Back to sign in"})]})})]})})}export{re as default};
